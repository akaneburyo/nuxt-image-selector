(window.webpackJsonp=window.webpackJsonp||[]).push([[5,3,4],{482:function(e,t,n){"use strict";n.r(t);var o=n(1),r=n(7),c=n(315),d=n(312),l=n(16),C=n(89),m=o.default.extend({components:{CBox:r.a,CImage:c.a,CAspectRatioBox:d.a,CIcon:l.a,CMenu:C.a,CMenuButton:C.b,CMenuList:C.c,CMenuItem:C.d,CMenuDivider:C.f},props:{imageUrl:{type:String,default:""}},computed:{},methods:{action:function(e){this.$emit(e)}}}),f=n(119),component=Object(f.a)(m,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("CAspectRatioBox",{attrs:{"max-w":"160px",ratio:1,position:"relative"}},[t("CBox",{attrs:{w:"100%",h:"100%",border:"1px",borderColor:"gray.200"}},[t("CImage",{attrs:{w:"100%",h:"100%",src:e.imageUrl,"object-fit":"contain"}}),e._v(" "),t("CBox",{attrs:{pos:"absolute",top:"8px",right:"8px"}},[t("CMenu",{scopedSlots:e._u([{key:"default",fn:function(n){var o=n.isOpen;return[t("CMenuButton",{attrs:{fontSize:"sm",opacity:"0.8",p:"2",_hover:{opacity:1},isActive:o,rightIcon:o?"chevron-up":"chevron-down"}},[e._v("\n          設定\n        ")]),e._v(" "),t("CMenuList",{attrs:{minW:"auto",w:"120px",placement:"bottom-end"}},[t("CMenuItem",{attrs:{fontSize:"sm"},on:{click:function(t){return e.action("toLeft")}}},[t("CIcon",{attrs:{size:"4",name:"arrow-left",mr:"2"}}),e._v("\n            左へ移動\n          ")],1),e._v(" "),t("CMenuItem",{attrs:{fontSize:"sm"},on:{click:function(t){return e.action("toRight")}}},[t("CIcon",{attrs:{size:"4",name:"arrow-right",mr:"2"}}),e._v("\n            右へ移動\n          ")],1),e._v(" "),t("CMenuDivider"),e._v(" "),t("CMenuItem",{attrs:{color:"red",fontSize:"sm"},on:{click:function(t){return e.action("onRemoved")}}},[t("CIcon",{attrs:{size:"4",name:"trash-can",mr:"2"}}),e._v("\n            削除\n          ")],1)],1)]}}])})],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports;n(337)(component,{CImage:n(118).CImage,CMenuButton:n(118).CMenuButton,CIcon:n(118).CIcon,CMenuItem:n(118).CMenuItem,CMenuDivider:n(118).CMenuDivider,CMenuList:n(118).CMenuList,CMenu:n(118).CMenu,CBox:n(118).CBox,CAspectRatioBox:n(118).CAspectRatioBox})},483:function(e,t,n){"use strict";n.r(t);var o=n(1),r=n(7),c=n(54),d=n(312),l=n(16),C=n(58),m=o.default.extend({components:{CBox:r.a,CFlex:c.a,CAspectRatioBox:d.a,CIcon:l.a,CText:C.a},methods:{onclick:function(){this.$emit("click")}}}),f=n(119),component=Object(f.a)(m,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("CAspectRatioBox",{attrs:{"max-w":"160px",ratio:1,as:"button",cursor:"pointer",_hover:{bg:"gray.100"}},on:{click:e.onclick}},[t("CFlex",{attrs:{w:"100%",h:"100%",border:"1px",borderColor:"gray.100",align:"center",justify:"center"}},[t("CBox",{attrs:{"text-align":"center"}},[t("CIcon",{attrs:{name:"add",mb:"2"}}),e._v(" "),t("CText",{attrs:{"font-size":"sm"},on:{click:e.onclick}},[e._v("画像を追加")])],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports;n(337)(component,{CIcon:n(118).CIcon,CText:n(118).CText,CBox:n(118).CBox,CFlex:n(118).CFlex,CAspectRatioBox:n(118).CAspectRatioBox})},489:function(e,t,n){"use strict";n.r(t);n(29),n(30),n(52),n(55);var o=n(488),r=n(50),c=n(22),d=(n(129),n(9),n(27),n(60),n(44),n(45),n(484),n(341),n(217),n(120),n(18),n(17),n(43),n(19),n(61),n(80),n(1)),l=n(7),C=n(316),m=n(102),f=n(54),v=n(317),h=n(314),x=n(58),I=n(16),M=n(209),y=n(35),_=n(313),w=n(482),B=n(483);function O(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function k(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?O(Object(source),!0).forEach((function(t){Object(c.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):O(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var S=d.default.extend({name:"IndexPage",components:{CBox:l.a,CSimpleGrid:C.a,CButton:m.a,CFlex:f.a,CStack:v.a,CHeading:h.a,CText:x.a,CIcon:I.a,CLink:M.a,CModal:y.a,CModalOverlay:y.g,CModalContent:y.d,CModalHeader:y.f,CModalBody:y.b,CModalCloseButton:y.c,CCode:_.a,SelectedImageCard:w.default,AddButton:B.default},data:function(){return{selectedImages:[],removedImages:[],isLoading:!1,modalContent:void 0}},methods:{addImage:function(){this.$refs.input&&this.$refs.input.click()},onImageSelected:function(e){var t,n,o=this,input=e.target;if((null===(t=input.files)||void 0===t?void 0:t.length)&&(null===(n=input.files)||void 0===n?void 0:n.length)>0){var r=this.selectedImages.length;Array.from(input.files).forEach((function(e,t){o.selectedImages.push({id:o.$utils.getRandomString(),raw:e,previewUrl:URL.createObjectURL(e),order:r+t})}))}input.files=null,input.value=""},moveToLeft:function(e){var t=this.selectedImages.find((function(image){return image.id===e})),n=t&&this.selectedImages.find((function(image){return image.order===t.order-1}));t&&n&&(t.order-=1,n.order+=1),this.selectedImages.sort((function(a,b){return a.order-b.order}))},moveToRight:function(e){var t=this.selectedImages.find((function(image){return image.id===e})),n=t&&this.selectedImages.find((function(image){return image.order===t.order+1}));t&&n&&(t.order+=1,n.order-=1),this.selectedImages.sort((function(a,b){return a.order-b.order}))},onRemoved:function(e){var t=this.selectedImages.find((function(image){return image.id===e}));t&&(this.removedImages.push(t),this.selectedImages=this.selectedImages.filter((function(image){return image.id!==e})).map((function(image,e){return k(k({},image),{},{order:e})})))},submit:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isLoading=!0,n=e.selectedImages.filter((function(image){return!!image.raw})).map((function(image){var body=new FormData;return body.append("id",image.id),image.raw&&body.append("raw",image.raw),body})),r=e.removedImages.map((function(image){return{id:image.id}})),c={images:e.selectedImages.map((function(image){return{id:image.id,order:image.order}}))},t.next=6,Promise.all([].concat(Object(o.a)(n.map((function(body){return e.$axios.post(e.$constants.api.path.postNewImage,body,{headers:{"content-type":"multipart/form-data"}})}))),Object(o.a)(r.map((function(body){return e.$axios.delete(e.$constants.api.path.deleteImage.replace(":id",body.id))}))),[e.$axios.post(e.$constants.api.path.postOrders,c)])).then((function(t){e.openModal({title:"Success.",code:null==t?void 0:t.map((function(e){return JSON.stringify(e.data,null,2)})).join("\n\n")})})).catch((function(t){e.$toast({title:"Error.",description:JSON.stringify(t),status:"error",duration:1e4})})).finally((function(){e.isLoading=!1}));case 6:case"end":return t.stop()}}),t)})))()},openModal:function(content){this.modalContent=k(k({},content),{},{isOpen:!0})},closeModal:function(){this.modalContent&&(this.modalContent.isOpen=!1)}}}),j=n(119),component=Object(j.a)(S,(function(){var e,t,n,o=this,r=o._self._c;o._self._setupProxy;return r("div",{staticClass:"container"},[r("CStack",{attrs:{spacing:"6",direction:"column",w:"100vw",h:"100vh",align:"center",justify:"center"}},[r("CStack",{attrs:{spacing:"4",direction:"row",align:"center"}},[r("CHeading",[o._v("nuxt-image-selector")]),o._v(" "),r("CLink",{attrs:{"is-external":"",href:"https://github.com/akaneburyo/nuxt-image-selector"}},[r("CIcon",{attrs:{size:"6",name:"github"}})],1)],1),o._v(" "),r("CFlex",{attrs:{justify:"center",direction:"row",align:"stretch"}},[r("CBox",{attrs:{w:"160px",bg:"gray.50",p:4}},[r("CText",{attrs:{"font-size":"md"}},[o._v("商品画像")])],1),o._v(" "),r("CStack",{attrs:{p:4,spacing:"4",align:"center",border:"1px",borderColor:"gray.100"}},[r("CSimpleGrid",{attrs:{columns:4,spacing:4,w:"640px"}},[o._l(o.selectedImages,(function(image){return r("SelectedImageCard",{key:image.id,attrs:{imageUrl:image.previewUrl},on:{toLeft:function(e){return o.moveToLeft(image.id)},toRight:function(e){return o.moveToRight(image.id)},onRemoved:function(e){return o.onRemoved(image.id)}}})})),o._v(" "),r("AddButton",{on:{click:o.addImage}})],2),o._v(" "),r("input",{ref:"input",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/jpeg, image/jpg, image/png",multiple:""},on:{change:o.onImageSelected}}),o._v(" "),r("CButton",{attrs:{variantColor:"green",w:"120px",isLoading:o.isLoading},on:{click:o.submit}},[o._v("\n          保存\n        ")])],1)],1)],1),o._v(" "),r("CModal",{attrs:{"is-open":null===(e=o.modalContent)||void 0===e?void 0:e.isOpen,"on-close":o.closeModal,size:"full",scrollBehavior:"inside"}},[r("CModalContent",{ref:"content"},[r("CModalHeader",[o._v(o._s(null===(t=o.modalContent)||void 0===t?void 0:t.title))]),o._v(" "),r("CModalCloseButton"),o._v(" "),r("CModalBody",[r("CCode",{attrs:{whiteSpace:"pre-wrap"}},[o._v(o._s(null===(n=o.modalContent)||void 0===n?void 0:n.code))])],1)],1),o._v(" "),r("CModalOverlay")],1)],1)}),[],!1,null,null,null);t.default=component.exports;n(337)(component,{CHeading:n(118).CHeading,CIcon:n(118).CIcon,CLink:n(118).CLink,CStack:n(118).CStack,CText:n(118).CText,CBox:n(118).CBox,CSimpleGrid:n(118).CSimpleGrid,CButton:n(118).CButton,CFlex:n(118).CFlex,CModalHeader:n(118).CModalHeader,CModalCloseButton:n(118).CModalCloseButton,CCode:n(118).CCode,CModalBody:n(118).CModalBody,CModalContent:n(118).CModalContent,CModalOverlay:n(118).CModalOverlay,CModal:n(118).CModal})}}]);